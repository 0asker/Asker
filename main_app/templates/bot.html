<!doctype html>
<html>
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<title>Faça-me uma pergunta!</title>
		
		<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css">
	</head>
	<body>
		
		<div id="campo_de_mensagens">
		</div>
		<br>
		<form method="post" class="form-inline" id="campo_enviar_mensagem">
			{% csrf_token %}
			<input type="text" name="text" class="form-control" required>
			<button type="submit" class="btn btn-outline-primary">
				<i class="far fa-paper-plane"></i>
			</button>
		</form>
		
		<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
		<script src="https://kit.fontawesome.com/1f965a8b94.js"></script>
		
		<script>
			campo_enviar_mensagem = document.getElementById("campo_enviar_mensagem");
			campo_enviar_mensagem.onsubmit = function() {
				
				msg = campo_enviar_mensagem.text.value;
				campo_enviar_mensagem.text.value = "";
				document.getElementById("campo_de_mensagens").innerHTML += "<span>Você: " + msg + "</span><br>";
				
				$.ajax({
					url: "/bot",
					type: "POST",
					data: {
						csrfmiddlewaretoken: "{{ csrf_token }}",
						text: msg,
					},
					complete: function(data) {
						response = data.responseText;
						
						document.getElementById("campo_de_mensagens").innerHTML += "<span>Bot: " + response + "</span><br>";
					}
				});
				
				return false;
			}
		</script>
	</body>
</html>
