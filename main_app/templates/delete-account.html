<!doctype html>
<html lang="pt-br">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<meta name="robots" content="noindex">
		
		<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css">
		
		<title>Apagar sua conta</title>
		
		<style>
			body {
				width: 50%;
				margin: auto;
			}
		</style>
	</head>
	<body>
		<p>Olá {{ user.username }}, é realmente uma pena sua decisão de deixar o Asker, você é muito importante para nós. Caso você volte, ficaremos muito felizes!</p>
		<p>Use o botão abaixo para excluir sua conta.</p>
		
		<button id="delete-account-button" class="btn btn-danger" onclick="delete_question()">Excluir minha conta</button>
		
		<script>
			function delete_question() {
				if(confirm("Você tem certeza que deseja excluir sua conta?")) {
					if(confirm("Hm... Você tem certeza ABSOLUTA que deseja excluir PERMANENTEMENTE sua conta?")) {
						delete_button = document.getElementById("delete-account-button")
						
						delete_button.disabled = true
						
						$.ajax({
							url: "/delete-account",
							type: "post",
							data: {
								"csrfmiddlewaretoken": "{{ csrf_token }}",
							},
							complete: function(data) {
								if(data.responseText == "False") {
									alert("Ocorreu um erro. Tente novamente mais tarde.")
									delete_button.disabled = false
								} else {
									alert("Conta deletada.")
									delete_button.remove()
									window.location.href = "/"
								}
							}
						})
					} else {
						alert("Ufa!")
					}
				} else {
					alert("Ufa!")
				}
			}
		</script>
		
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
	</body>
</html>
