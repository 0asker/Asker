{% spaceless %}
{% load humanize %}
{% load main_app_extras %}
<!doctype html>
<html lang="pt-br">
<head>
<title>Asker | Página inicial</title>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<style id="wait">
	body {
		visibility: hidden;
		opacity: 0;
	}
</style>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css">
<link rel="stylesheet" href="/static/css/common.css?v=3">
<script src="/static/js/cookieman.js?v=1"></script>
<script>
	var cssfn = 'light.css';
	var cssversion = '?v=3';
	if (getDarkCookie() == 'true') { cssfn = 'dark.css'; }
	var link = document.createElement('link');
	link.rel = 'stylesheet';
	link.type = 'text/css';
	link.href = '/static/css/' + cssfn + cssversion;
	document.head.appendChild(link);

	document.getElementById('wait').remove();
</script>

<style>
.popular-question-img {
	display: block;
	max-width: 60%;
}

@media (min-width: 320px) and (max-width: 480px) {
	.popular-question-img {
		max-width: 80%;
	}
}
</style>

</head>

	<body>
	{% include "includes/navbar.html" %}
	{{ account_verification_alert|safe }}
	<main>
		
		{% if request.META.HTTP_HOST == "asker.pythonanywhere.com" %}
			<div class="alert alert-success">
				<div class="alert-heading">
					<h3>Aviso!</h3>
				</div>
				<p>O Asker está agora disponível no domínio <a href="https://br.asker.fun">br.asker.fun</a>. Ou, mais fácil: <a href="http://asker.fun">asker.fun</a></p>
			</div>
		{% endif %}
		
		<ul class="nav nav-tabs" id="tabs">
			<li class="nav-item">
				<span class="nav-link main-tab bg-main-tab" id="popular">Popular</span>
			</li>
			<li class="nav-item">
				<span class="nav-link main-tab bg-main-tab" id="news">Novas perguntas</span>
			</li>
		</ul>
<!-- Questões recentes -->
<section class="card bg-main" id="n_questions">
{% include "base/recent-questions-pjax.html" %}
</section>
<!-- !Questões recentes -->

<!-- Questões populares -->
<section class="card bg-main" id="p_questions">
	<ul class="list-group list-group-flush infinite-container">
		{% for question in popular_questions %}
		<li class="list-group-item bg-main">
			<div class="card-body">

        <a href="/question/{{ question.id }}">
          <p>
            <b>
              {{ question.text }}
            </b>
          </p>
        </a>

					{% if question.description != '' %}
            <p>
              {{ question.description|cut_description|safe|linebreaksbr }}
            </p>
          {% endif %}
          
          {% if question.image %}
						<img src="{{ question.image.url }}" class="popular-question-img">
						<br>
          {% endif %}
          
				<small>{% total_answers question.id %} respostas <b>&nbsp;|&nbsp;</b> <span class="text-muted"><img src="/static/images/white-heart.png?version=3" width="15px"> {{ question.total_likes }}</span></small><small><b>&nbsp;|&nbsp;</b></small><small>{% question_total_views question.id %} visualizações</small>
				{% if user.is_authenticated %}
					{% answered user.username question.id as ANSWERED %}
					{% if ANSWERED %}
				<span style="display: block"><b>Sua resposta:</b></span> {% answer user.username question.id %}
					{% else %}
				<a style="display: block" href="/question/{{ question.id }}"><button class="btn btn-outline-primary">Responder</button></a>
					{% endif %}
				{% else %}
				<p><a href="/signin?redirect=/question/{{ question.id }}">Faça login</a> ou <a href="/signup?redirect=/question/{{ question.id }}">crie uma conta</a> para responder está pergunta.</p>
			{% endif %}
			</div>
		</li>
		{% endfor %}
	</ul>
	<h5>Fim! <a href="/news">Clique aqui</a> para ver as novas perguntas.</h5>
</section>
<!-- !Questões populares -->
	</main>

		<script src="/static/js/index.js?v=9"></script>
		<script>
if (getDarkCookie() == 'true') {
	document.getElementsByClassName('navbar')[0].classList.remove("navbar-light");
	document.getElementsByClassName('navbar')[0].classList.add("navbar-dark");
}
		</script>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://kit.fontawesome.com/1f965a8b94.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"></script>
	</body>
</html>
{% endspaceless %}
